# 状态栏颜色管理功能说明

## 功能概述

通过智能的meta标签管理，为不同页面和阅读模式提供最适合的状态栏颜色体验：

- **非阅读页面**：根据系统主题（浅色/深色模式）自动切换状态栏颜色
- **阅读页面**：根据阅读背景色动态调整状态栏颜色，确保视觉一致性

## 技术实现

### 1. 基础设置（index.html）

```html
<!-- 基础状态栏颜色 - 非阅读页面 -->
<meta name="theme-color" content="#18a058" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#36ad6a" media="(prefers-color-scheme: dark)">
```

### 2. 状态栏颜色管理器（themeColorManager.js）

核心管理器，提供以下功能：

- `setPageThemeColor()` - 设置非阅读页面状态栏颜色
- `setReaderThemeColor(options)` - 设置阅读页面状态栏颜色
- `restoreDefaultThemeColor()` - 恢复默认状态栏颜色
- `adjustColorForStatusBar()` - 智能调整颜色以适应状态栏显示

### 3. 阅读页面集成（ReaderView.vue）

- 初始化时根据当前阅读背景设置状态栏颜色
- 监听阅读设置变化（背景色、系统主题）自动更新状态栏颜色
- 页面卸载时恢复默认状态栏颜色

### 4. 应用级集成（App.vue）

- 监听路由变化，非阅读页面自动应用默认状态栏颜色
- 确保整个应用的状态栏颜色一致性

## 颜色方案

### 非阅读页面
- **浅色模式**：#18a058（主绿色）
- **深色模式**：#36ad6a（稍亮的绿色）

### 阅读页面
根据阅读背景色智能调整：

- **纸张背景（#f7f3e8）** → 浅色状态栏
- **绿色背景（#e9f5ec）** → 浅色状态栏  
- **深色背景（#0f0f11）** → 深色状态栏

## 使用方法

### 开发者使用

1. **引入管理器**：
```javascript
import themeColorManager from '@/utils/themeColorManager'
```

2. **设置阅读页面状态栏颜色**：
```javascript
themeColorManager.setReaderThemeColor({
  backgroundColor: '#f7f3e8',
  isDark: false
})
```

3. **设置普通页面状态栏颜色**：
```javascript
themeColorManager.setPageThemeColor()
```

### 用户体验

- **无缝切换**：用户在阅读和非阅读页面间切换时，状态栏颜色会平滑过渡
- **主题适配**：支持系统浅色/深色模式自动切换
- **阅读优化**：阅读页面状态栏颜色会根据背景色智能调整，保护视力

## 浏览器兼容性

- **Android Chrome**：完全支持
- **Safari iOS**：部分支持（可能忽略动态变化）
- **桌面浏览器**：作为PWA或添加到主屏幕时生效

## 注意事项

1. **动态变化**：某些浏览器可能不会立即响应动态的状态栏颜色变化
2. **系统限制**：某些手机系统可能限制状态栏颜色的修改范围
3. **性能考虑**：状态栏颜色变化不应影响应用性能

## 技术细节

### 颜色调整算法
状态栏颜色会根据阅读背景进行智能调整：
- 浅色背景：颜色亮度提升10%
- 深色背景：颜色亮度降低10%
- 确保状态栏文字的可读性

### 路由监听
- 阅读页面进入：自动切换到阅读模式状态栏颜色
- 阅读页面离开：自动恢复默认状态栏颜色
- 非阅读页面间切换：保持默认状态栏颜色不变